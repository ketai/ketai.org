<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="description"><meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href='http://fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
    <!-- Stylesheets -->
    <link rel="stylesheet" href="/assets/styles/html5reset.css" media="all">
    <link rel="stylesheet" href="/assets/styles/responsivegridsystem.css" media="all">
    <link rel="stylesheet" href="/assets/styles/6cols.css" media="all">
    <!-- Responsive Stylesheets -->
    <link rel="stylesheet" media="only screen and (max-width: 1024px) and (min-width: 769px)" href="/assets/styles/1024.css">
    <link rel="stylesheet" media="only screen and (max-width: 768px) and (min-width: 481px)" href="/assets/styles/768.css">
    <link rel="stylesheet" media="only screen and (max-width: 480px)" href="/assets/styles/480.css">
    <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements and feature detects -->
    <script src="/assets/scripts/modernizr-2.5.3-min.js"></script><link rel="stylesheet" type="text/css" href="/assets/styles/menu_sideslide.css" />
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/assets/styles/code_block.css" />
    <link rel="stylesheet" href="/assets/styles/search.css">
    <link rel="stylesheet" href="/assets/styles/code_example.css">
    <title>Ketai Library - Data Capture</title>
  </head>
</html>
<body>
<div class="menu-wrap">
  <nav class="menu">
    <div class="icon-list">
<ul class="menu"> 
  <div>
    <li><a href="/">Home</a></li>
    <li><a href="/get-started/">Get Started</a></li>
    <li><a href="/examples/">Examples</a></li>
    <li><a href="/reference/">Reference</a></li>
    <li><a href="/download/">Download</a></li><br/><script>(function() {var cx = '000151488356480034415:ixgzbzp0hcq';    var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +'//cse.google.com/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only><br/>
    <li><a href="https://github.com/ketai/library" class="misc_link"><i class="fa fa-github"> Github</i></a></li>
    <li><a href="https://github.com/ketai/ketai/pulls" class="misc_link"><i class="fa fa-code"> Your Help</i></a></li>
    <li><a href="https://github.com/ketai/ketai/issues" class="misc_link"><i class="fa fa-comment-o"> Forum</i></a></li>
    <li><a href="https://twitter.com/ketailibrary" class="misc_link"><i class="fa fa-twitter"> Twitter</i></a></li>
  </div>
</ul>
    </div>
  </nav>
  <button id="close-button" class="close-button">Close Menu</button>
</div>
<button id="open-button" class="menu-button">Open Menu</button>
<div class="title">
  <nav class="menu"></nav>
</div>
  <div id="wrapper">
    <div class="title">
      <h2>Ketai</h2>
    </div>
    <div id="maincontentcontainer">
      <div class="maincontent">
        <div class="section group">
          <div class="col span_1_of_6 menubar"><a href="/"><img src="/assets/images/ketai_black.png" class="top"><img src="/assets/images/ketai_v10.png" class="bottom"></a>
<ul class="menu"> 
  <div>
    <li><a href="/">Home</a></li>
    <li><a href="/get-started/">Get Started</a></li>
    <li><a href="/examples/">Examples</a></li>
    <li><a href="/reference/">Reference</a></li>
    <li><a href="/download/">Download</a></li><br/><script>(function() {var cx = '000151488356480034415:ixgzbzp0hcq';    var gcse = document.createElement('script');gcse.type = 'text/javascript';gcse.async = true;gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +'//cse.google.com/cse.js?cx=' + cx;var s = document.getElementsByTagName('script')[0];s.parentNode.insertBefore(gcse, s);})();</script><gcse:searchbox-only></gcse:searchbox-only><br/>
    <li><a href="https://github.com/ketai/library" class="misc_link"><i class="fa fa-github"> Github</i></a></li>
    <li><a href="https://github.com/ketai/ketai/pulls" class="misc_link"><i class="fa fa-code"> Your Help</i></a></li>
    <li><a href="https://github.com/ketai/ketai/issues" class="misc_link"><i class="fa fa-comment-o"> Forum</i></a></li>
    <li><a href="https://twitter.com/ketailibrary" class="misc_link"><i class="fa fa-twitter"> Twitter</i></a></li>
  </div>
</ul>
            <hr>
<h4><b>Other Examples:</b></h4>
<ul class="sidelist_menu">
  <li><a href="/examples/accelerometer/">Accelerometer</a></li>
  <li><a href="/examples/audioinput/">Audio Input</a></li>
  <li><a href="/examples/bluetoothcursors/">Bluetooth Connection</a></li>
  <li><a href="/examples/cameragettingstarted/">Getting Camera Started</a></li>
  <li><a href="/examples/datacapture/" class="active">Data Capture</a></li>
  <li><a href="/examples/externalsqliteloading/">External SQLite Loading</a></li>
  <li><a href="/examples/facedetector/">Face Detector</a></li>
  <li><a href="/examples/geolocation/">Geolocation</a></li>
  <li><a href="/examples/gestures/">Gestures</a></li>
  <li><a href="/examples/gyroscope/">Gyroscope</a></li>
  <li><a href="/examples/locationdistance/">Location Distance</a></li>
  <li><a href="/examples/multiplesensors/">Multiple Sensors</a></li>
  <li><a href="/examples/nfcbeam/">NFC Beam</a></li>
  <li><a href="/examples/nfcread/">NFC Read</a></li>
  <li><a href="/examples/nfcwrite/">NFC Write</a></li>
  <li><a href="/examples/sqlite/">SQLite</a></li>
  <li><a href="/examples/ui/">UI</a></li>
  <li><a href="/examples/wifidirect-remotecursor/">WiFi Direct - Remote Cursor</a></li>
</ul>
          </div>
          <div class="col span_4_of_6 reference">
            <h3>Examples</h3><h4 id="data-capture">Data Capture</h4>
<p>This is the example for Data Capture</p>
<hr>
<div class="link"><a href="DataCapture.pde"><i class="fa fa-download fa-lg"></i> DataCapture. pde</a></div>

<pre><code>import ketai.data.*;
import ketai.sensors.*;

KetaiSensor sensor;
KetaiSQLite db;
Boolean isCapturing = false;

String CREATE_DB_SQL = &quot;CREATE TABLE data ( time INTEGER PRIMARY KEY, x FLOAT NOT NULL, y FLOAT NOT NULL, z FLOAT NOT NULL);&quot;;

void setup()
{
  db = new KetaiSQLite(this);
  sensor = new KetaiSensor(this);
  frameRate(5);
  orientation(LANDSCAPE);
  textAlign(CENTER, CENTER);
  textSize(36);

  //lets make our table if it is the first time we&#39;re running 
  if ( db.connect() )
  {
    // for initial app launch there are no tables so we make one
    if (!db.tableExists(&quot;data&quot;))
      db.execute(CREATE_DB_SQL);
  }
  sensor.start();
}

void draw() {
  background(78, 93, 75);
  // Status and data count
  if (isCapturing)
    text(&quot;Recording Accellerometer Data...\n(touch screen to stop)&quot;, width/2, height/4);
  else
  {
    plotData();
    text(&quot;Visualizing last &quot; + width + &quot; point(s) of data.&quot;, width/2, height/4);
  } 
  text(&quot;Current Data count: &quot; + db.getDataCount(), width/2, height-height/4);
}

void mousePressed()
{
  if (isCapturing)
    isCapturing = false;
  else
    isCapturing = true;
}
/*
      collect accelerometer data and save it to the database
*/
void onAccelerometerEvent(float x, float y, float z, long time, int accuracy)
{
  if (db.connect() &amp;&amp; isCapturing)
  {
    if (!db.execute(&quot;INSERT into data (`time`,`x`,`y`,`z`) VALUES (&#39;&quot;+System.currentTimeMillis()+&quot;&#39;, &#39;&quot;+x+&quot;&#39;, &#39;&quot;+y+&quot;&#39;, &#39;&quot;+z+&quot;&#39;)&quot;))
      println(&quot;Failed to record data!&quot; );
  }
}

void plotData()
{
  if (db.connect())
  {
    pushStyle();
    noStroke();
    db.query( &quot;SELECT * FROM data ORDER BY time DESC LIMIT &quot; + width );
    int  i = 0;   
    long mymin = Long.parseLong(db.getFieldMin(&quot;data&quot;, &quot;time&quot;));
    long mymax = Long.parseLong(db.getFieldMax(&quot;data&quot;, &quot;time&quot;));
    while (db.next ())
    {

      float x = db.getFloat(&quot;x&quot;);
      float y = db.getFloat(&quot;y&quot;);
      float z = db.getFloat(&quot;z&quot;);
      long  t = db.getLong(&quot;time&quot;);
      int plotx = (int)maplong(t, mymin, mymax, 0, width);

      fill(255, 0, 0);
      ellipse(plotx, map(x, -30, 30, 0, height), 5, 5);
      fill(0, 255, 0);
      ellipse(i, map(y, -30, 30, 0, height), 5, 5);
      fill(0, 0, 255);
      ellipse(i, map(z, -30, 30, 0, height), 5, 5);

      i++;
    }
    popStyle();
  }
}

long maplong(long value, long istart, long istop, long ostart, long ostop) {
  long divisor = istop - istart;
  return (ostart + (ostop - ostart) * (value - istart) / divisor);
}
</code></pre><img src="/assets/thumbnails/77728e6c5a00ec8bf38d33095632f034.png" width="800" height="480"></img>
          </div>
        </div>
      </div>
    </div>
  </div><script src="/assets/scripts/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script><script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="/assets/scripts/jquery-1.7.2.min.js"><\/script>')</script>
  <script src="/assets/scripts/classie.js"></script>
  <script src="/assets/scripts/menu.js"></script>
  <script src="/assets/scripts/responsivegridsystem.js"></script>
</body>